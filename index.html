<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Warung Rasa Padu - Pesan Sekarang</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #fffaf0;
            scroll-behavior: smooth;
        }
        .hero-bg {
            background-image: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('https://i.postimg.cc/rm37zbjT/image.png');
            background-size: cover;
            background-position: center;
        }
        
        /* Tema Latar Belakang Kategori */
        .bg-pattern-makanan {
            background-color: #fff7ed;
            background-image: radial-gradient(#ffedd5 1px, transparent 1px);
            background-size: 20px 20px;
        }
        .bg-pattern-minuman {
            background-color: #f0f9ff;
            background-image: radial-gradient(#e0f2fe 1px, transparent 1px);
            background-size: 20px 20px;
        }
        .bg-pattern-pencuci-mulut {
            background-color: #fdf2f8;
            background-image: radial-gradient(#fce7f3 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .cart-scroll::-webkit-scrollbar, .modal-scroll::-webkit-scrollbar {
            width: 5px;
        }
        .cart-scroll::-webkit-scrollbar-thumb, .modal-scroll::-webkit-scrollbar-thumb {
            background: #f97316;
            border-radius: 10px;
        }
        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(234, 88, 12, 0.2);
        }
    </style>
</head>
<body class="text-gray-800 antialiased overflow-x-hidden">

    <!-- NAVBAR -->
    <nav class="fixed w-full top-0 z-50 bg-white/90 backdrop-blur-md shadow-sm border-b border-gray-100">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center gap-2">
                <i class="ph-fill ph-storefront text-3xl text-orange-600"></i>
                <span class="text-xl font-bold text-gray-900 tracking-tight">Warung <span class="text-orange-600">Rasa Padu</span></span>
            </div>
            <button onclick="toggleCart(true)" class="relative p-2 bg-orange-100 rounded-full text-orange-700 hover:bg-orange-200 transition shadow-sm border border-orange-200">
                <i class="ph-bold ph-shopping-cart text-2xl"></i>
                <span id="cart-count" class="absolute -top-1 -right-1 bg-red-600 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full hidden">0</span>
            </button>
        </div>
    </nav>

    <!-- HERO SECTION -->
    <header class="hero-bg h-[50vh] flex items-center justify-center text-center text-white px-4 pt-16">
        <div class="max-w-3xl">
            <h1 class="text-4xl md:text-5xl font-extrabold mb-4 leading-tight">Makan Sedap, <br><span class="text-orange-500">Hati Senang!</span></h1>
            <p class="text-lg mb-8 text-gray-200">Pilih menu, tambah ke troli, dan hantar pesanan anda terus ke WhatsApp kami.</p>
        </div>
    </header>

    <!-- CATEGORY SECTION -->
    <main id="menu" class="container mx-auto px-4 py-12">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-5xl mx-auto">
            <!-- Makanan -->
            <div onclick="openCategoryModal('makanan')" class="category-card bg-white p-6 rounded-[2rem] border border-orange-100 text-center cursor-pointer transition-all duration-300 shadow-sm">
                <div class="w-20 h-20 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="ph-fill ph-bowl-food text-4xl text-orange-600"></i>
                </div>
                <h4 class="text-xl font-bold mb-1 text-orange-900">Makanan</h4>
                <p class="text-gray-500 text-xs mb-4">Nasi Goreng, Ayam Bakar & Sate</p>
                <span class="inline-block bg-orange-600 text-white font-bold py-2 px-6 rounded-full text-xs">LIHAT MENU</span>
            </div>

            <!-- Minuman -->
            <div onclick="openCategoryModal('minuman')" class="category-card bg-white p-6 rounded-[2rem] border border-blue-100 text-center cursor-pointer transition-all duration-300 shadow-sm">
                <div class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="ph-fill ph-brandy text-4xl text-blue-600"></i>
                </div>
                <h4 class="text-xl font-bold mb-1 text-blue-900">Minuman</h4>
                <p class="text-gray-500 text-xs mb-4">Teh Ais, Milo & Jus Segar</p>
                <span class="inline-block bg-blue-600 text-white font-bold py-2 px-6 rounded-full text-xs">LIHAT MENU</span>
            </div>

            <!-- Pencuci Mulut -->
            <div onclick="openCategoryModal('pencuci-mulut')" class="category-card bg-white p-6 rounded-[2rem] border border-pink-100 text-center cursor-pointer transition-all duration-300 shadow-sm">
                <div class="w-20 h-20 bg-pink-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="ph-fill ph-ice-cream text-4xl text-pink-600"></i>
                </div>
                <h4 class="text-xl font-bold mb-1 text-pink-900">Pencuci Mulut</h4>
                <p class="text-gray-500 text-xs mb-4">Cendol, ABC & Kuih-Muih</p>
                <span class="inline-block bg-pink-600 text-white font-bold py-2 px-6 rounded-full text-xs">LIHAT MENU</span>
            </div>
        </div>
    </main>

    <!-- MENU MODAL -->
    <div id="menu-modal" class="fixed inset-0 bg-black/70 z-[80] hidden flex items-center justify-center p-4 backdrop-blur-sm">
        <div id="modal-container" class="bg-white w-full max-w-4xl h-[85vh] rounded-[2rem] overflow-hidden flex flex-col relative transition-all duration-300">
            <!-- Modal Header -->
            <div id="modal-header" class="p-5 border-b flex justify-between items-center">
                <h2 id="modal-title" class="text-xl font-bold text-gray-900 capitalize flex items-center gap-2">
                    <i class="ph-bold ph-list-bullets"></i> Kategori
                </h2>
                <button onclick="closeModal()" class="w-10 h-10 bg-white border rounded-full flex items-center justify-center hover:bg-red-50 hover:text-red-600 transition shadow-sm">
                    <i class="ph-bold ph-x text-lg"></i>
                </button>
            </div>

            <!-- Modal Content (Grid Items) -->
            <div id="modal-grid" class="flex-1 overflow-y-auto p-6 grid grid-cols-1 sm:grid-cols-2 gap-5 modal-scroll">
                <!-- Items injected by JS -->
            </div>
            
            <div class="p-3 bg-white/80 backdrop-blur-sm text-center border-t">
                <p class="text-[10px] text-gray-400 font-medium italic">Sentuh butang "Tambah Ke Troli" untuk memesan.</p>
            </div>
        </div>
    </div>

    <!-- CART SIDEBAR -->
    <div id="cart-overlay" class="fixed inset-0 bg-black/60 z-[90] hidden" onclick="toggleCart(false)"></div>
    <aside id="cart-sidebar" class="fixed right-0 top-0 h-full w-full max-w-md bg-white z-[100] shadow-2xl flex flex-col transform translate-x-full transition-transform duration-300">
        <div class="p-5 border-b flex justify-between items-center bg-white sticky top-0">
            <h2 class="text-xl font-bold flex items-center gap-2 text-orange-600"><i class="ph-bold ph-shopping-bag"></i> Pesanan Anda</h2>
            <button onclick="toggleCart(false)" class="p-2 hover:bg-gray-100 rounded-full transition"><i class="ph-bold ph-x text-xl"></i></button>
        </div>
        <div id="cart-list" class="flex-1 overflow-y-auto p-5 space-y-3 cart-scroll"></div>
        <div id="cart-footer" class="p-6 border-t bg-gray-50 hidden">
            <div class="mb-4">
                <label class="text-xs font-bold text-gray-500 mb-1 block">NAMA ANDA</label>
                <input type="text" id="cust-name" class="w-full border rounded-xl px-4 py-3 outline-none focus:ring-2 focus:ring-orange-500 shadow-sm bg-white" placeholder="Contoh: Siti Aminah">
            </div>
            <div class="bg-orange-100/50 p-4 rounded-xl mb-6 flex justify-between items-center border border-orange-200">
                <span class="font-bold text-gray-600">Jumlah Bayaran:</span>
                <span id="grand-total" class="text-2xl font-black text-orange-600">RM 0.00</span>
            </div>
            <button onclick="sendOrder()" class="w-full bg-green-600 text-white font-bold py-4 rounded-2xl flex justify-center items-center gap-2 shadow-lg hover:bg-green-700 transition active:scale-95">
                <i class="ph-bold ph-whatsapp-logo text-2xl"></i> PESAN KE WHATSAPP
            </button>
        </div>
    </aside>

    <script>
        const menuData = [
            // MAKANAN
            { id: 1, cat: 'makanan', name: "Nasi Lemak Ayam Berempah", price: 12.00, img: "https://i.postimg.cc/MpSkrQjS/image.png", desc: "Ayam goreng rempah rangup." },
            { id: 2, cat: 'makanan', name: "Nasi Goreng Kampung", price: 9.50, img: "https://i.postimg.cc/fL0BN8Gs/image.png", desc: "Ikan bilis & kangkung belacan." },
            { id: 3, cat: 'makanan', name: "Char Kuey Teow Special", price: 10.00, img: "https://i.postimg.cc/cJTN3LCq/image.png", desc: "Udang segar & telur itik." },
            { id: 4, cat: 'makanan', name: "Burger Daging Cheese", price: 14.50, img: "https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=400", desc: "Patty tebal & cheese cair." },
            { id: 5, cat: 'makanan', name: "Mee Goreng Mamak", price: 8.00, img: "https://images.unsplash.com/photo-1552611052-33e04de081de?w=400", desc: "Gorengan kuali panas klasik." },
            { id: 6, cat: 'makanan', name: "Ayam Goreng Crispy (2pcs)", price: 9.00, img: "https://i.postimg.cc/htnvfZZY/image.png", desc: "Rangup di luar, juicy di dalam." },
            { id: 7, cat: 'makanan', name: "Satay Ayam (10 Cucuk)", price: 15.00, img: "https://i.postimg.cc/jSRqswCf/image.png", desc: "Diperap rempah & bakar arang." },
            { id: 8, cat: 'makanan', name: "Sate Daging (10 Cucuk)", price: 18.00, img: "https://i.postimg.cc/brLCkBHt/image.png", desc: "Daging lembu premium." },
            { id: 9, cat: 'makanan', name: "Nasi Kerabu Ayam Bakar", price: 15.00, img: "https://i.postimg.cc/Cx9vGDDH/image.png", desc: "Nasi biru & ulam segar." },
            { id: 10, cat: 'makanan', name: "Laksa Utara", price: 8.50, img: "https://i.postimg.cc/yd10cYfG/image.png", desc: "Kuah ikan pekat & telur." },
            { id: 11, cat: 'makanan', name: "Nasi Ayam Penyet", price: 13.00, img: "https://i.postimg.cc/sXgZ1HX7/image.png", desc: "Sambal terasi berapi." },
            { id: 12, cat: 'makanan', name: "Mee Bandung Muar", price: 11.00, img: "https://i.postimg.cc/hPZgqyWg/image.png", desc: "Kuah udang geragau pekat." },
            { id: 14, cat: 'makanan', name: "Soto Ayam Power", price: 7.50, img: "https://i.postimg.cc/MGWhM18b/image.png", desc: "Sup berempah & sambal kicap." },
            { id: 15, cat: 'makanan', name: "Mee Kari Kapal", price: 9.50, img: "https://i.postimg.cc/QMzG2VRc/image.png", desc: "Kari santan & kerang besar." },
            { id: 16, cat: 'makanan', name: "Nasi Lemak Paru Goreng", price: 10.00, img: "https://i.postimg.cc/xdcB3ncP/image.png", desc: "Paru goreng sambal rangup." },
            { id: 17, cat: 'makanan', name: "Maggi Goreng Double", price: 9.00, img: "https://i.postimg.cc/VsjpR7LT/image.png", desc: "Maggi kari garing." },
            { id: 18, cat: 'makanan', name: "Kuey Teow Ladna", price: 9.50, img: "https://i.postimg.cc/4dpLWdZm/image.png", desc: "Kuah pekat seafood." },
            { id: 19, cat: 'makanan', name: "Lontong Kering", price: 11.50, img: "https://i.postimg.cc/hjGvrJVC/image.png", desc: "Rendang daging & serunding." },
            { id: 20, cat: 'makanan', name: "Roti John Meleleh", price: 10.00, img: "https://i.postimg.cc/N0sjsyJ3/image.png", desc: "Inti daging & sos cheese." },

            // MINUMAN
            { id: 21, cat: 'minuman', name: "Teh Ais Padu", price: 4.50, img: "https://i.postimg.cc/5977pZW7/image.png", desc: "Teh susu kaw buih melimpah." },
            { id: 22, cat: 'minuman', name: "Sirap Bandung Cincau", price: 5.50, img: "https://i.postimg.cc/C5SgN9yR/image.png", desc: "Sirap merah & cincau segar." },
            { id: 23, cat: 'minuman', name: "Milo Ais Dinosaur", price: 6.50, img: "https://i.postimg.cc/QtqPXtPC/image.png", desc: "Limpahan serbuk Milo." },
            { id: 24, cat: 'minuman', name: "Kopi O Ais Kaw", price: 3.50, img: "https://i.postimg.cc/NjhxztJb/image.png", desc: "Kopi kampung hitam pekat." },
            { id: 25, cat: 'minuman', name: "Jus Tembikai Laici", price: 7.00, img: "https://i.postimg.cc/PrDWZcXZ/image.png", desc: "Tembikai & laici manis." },
            { id: 26, cat: 'minuman', name: "Teh O Limau Ais", price: 3.50, img: "https://i.postimg.cc/xjhhycmR/image.png", desc: "Menyegarkan dahaga." },
            { id: 27, cat: 'minuman', name: "Barli Ais Home-made", price: 4.00, img: "https://i.postimg.cc/pVh1TRSf/image.png", desc: "Masakan barli asli." },
            { id: 28, cat: 'minuman', name: "Nescafe Ais", price: 4.50, img: "https://i.postimg.cc/0yBwbRFN/image.png", desc: "Berkrim & klasik." },
            { id: 29, cat: 'minuman', name: "Air Kelapa Muda", price: 6.00, img: "https://i.postimg.cc/d3Ydw2X4/image.png", desc: "Asli dari buah kelapa." },
            { id: 30, cat: 'minuman', name: "Ribena Longan", price: 6.00, img: "https://i.postimg.cc/43pxZDg4/image.png", desc: "Ribena & isi longan manis." },

            // PENCUCI MULUT
            { id: 31, cat: 'pencuci-mulut', name: "Cendol Durian", price: 12.00, img: "https://images.unsplash.com/photo-1590301157890-4810ed352733?w=400", desc: "Durian asli & gula melaka." },
            { id: 32, cat: 'pencuci-mulut', name: "ABC Gunung Berapi", price: 8.50, img: "https://images.unsplash.com/photo-1563805042-7684c019e1cb?w=400", desc: "Limpahan pelbagai sirap." },
            { id: 33, cat: 'pencuci-mulut', name: "Puding Raja", price: 10.00, img: "https://images.unsplash.com/photo-1551024601-bec78aea704b?w=400", desc: "Pisang & kuah kastard." },
            { id: 34, cat: 'pencuci-mulut', name: "Pisang Goreng Cheese", price: 9.00, img: "https://images.unsplash.com/photo-1590080875515-8a3a8dc5735e?w=400", desc: "Parutan cheese melimpah." },
            { id: 35, cat: 'pencuci-mulut', name: "Keropok Lekor Garing", price: 5.00, img: "https://images.unsplash.com/photo-1563805042-7684c019e1cb?w=400", desc: "Lekor Terengganu asli." }
        ];

        let cart = [];

        function openCategoryModal(category) {
            const modal = document.getElementById('menu-modal');
            const container = document.getElementById('modal-container');
            const grid = document.getElementById('modal-grid');
            const title = document.getElementById('modal-title');
            const header = document.getElementById('modal-header');

            const filtered = menuData.filter(item => item.cat === category);
            
            container.className = "bg-white w-full max-w-4xl h-[85vh] rounded-[2rem] overflow-hidden flex flex-col relative transition-all duration-300";
            
            if (category === 'makanan') {
                container.classList.add('bg-pattern-makanan');
                header.className = "p-5 border-b flex justify-between items-center bg-orange-100/50";
                title.innerHTML = `<i class="ph-bold ph-bowl-food text-orange-600"></i> Menu Makanan`;
            } else if (category === 'minuman') {
                container.classList.add('bg-pattern-minuman');
                header.className = "p-5 border-b flex justify-between items-center bg-blue-100/50";
                title.innerHTML = `<i class="ph-bold ph-brandy text-blue-600"></i> Menu Minuman`;
            } else {
                container.classList.add('bg-pattern-pencuci-mulut');
                header.className = "p-5 border-b flex justify-between items-center bg-pink-100/50";
                title.innerHTML = `<i class="ph-bold ph-ice-cream text-pink-600"></i> Menu Pencuci Mulut`;
            }
            
            grid.innerHTML = filtered.map(item => `
                <div class="flex items-center gap-4 bg-white/80 backdrop-blur-sm p-4 rounded-3xl border border-white shadow-sm hover:shadow-md transition">
                    <img src="${item.img}" class="w-24 h-24 object-cover rounded-2xl shadow-md" onerror="this.src='https://placehold.co/400x400?text=Imej+Tiada'">
                    <div class="flex-1 min-w-0">
                        <h5 class="font-bold text-gray-900 text-sm md:text-base truncate">${item.name}</h5>
                        <p class="text-[11px] text-gray-500 mb-2">${item.desc}</p>
                        <div class="flex flex-col gap-2">
                            <span class="text-orange-600 font-black text-sm">RM ${item.price.toFixed(2)}</span>
                            <button onclick="addToCart(${item.id})" class="bg-orange-600 text-white px-4 py-2.5 rounded-xl flex items-center justify-center gap-2 text-[11px] font-bold hover:bg-orange-700 active:scale-95 transition shadow-sm">
                                <i class="ph-bold ph-plus-circle"></i> TAMBAH KE TROLI
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');

            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            document.getElementById('menu-modal').classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        function toggleCart(show) {
            const sidebar = document.getElementById('cart-sidebar');
            const overlay = document.getElementById('cart-overlay');
            if (show) {
                sidebar.classList.remove('translate-x-full');
                overlay.classList.remove('hidden');
            } else {
                sidebar.classList.add('translate-x-full');
                overlay.classList.add('hidden');
            }
        }

        function addToCart(id) {
            const item = menuData.find(m => m.id === id);
            const found = cart.find(c => c.id === id);
            if (found) {
                found.qty += 1;
            } else {
                cart.push({ ...item, qty: 1 });
            }
            updateUI();
            // Makluman ringkas (Toast) boleh ditambah di sini jika perlu
            toggleCart(true); 
        }

        function updateUI() {
            const list = document.getElementById('cart-list');
            const footer = document.getElementById('cart-footer');
            const countBadge = document.getElementById('cart-count');
            const totalEl = document.getElementById('grand-total');

            const totalItems = cart.reduce((sum, item) => sum + item.qty, 0);
            const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.qty), 0);

            countBadge.textContent = totalItems;
            countBadge.classList.toggle('hidden', totalItems === 0);

            if (cart.length === 0) {
                list.innerHTML = `
                    <div class="text-center py-24 text-gray-300">
                        <i class="ph-bold ph-shopping-cart text-6xl mb-3"></i>
                        <p class="font-medium text-sm">Troli anda masih kosong.</p>
                        <button onclick="toggleCart(false)" class="mt-4 text-orange-600 font-bold text-xs underline underline-offset-4">Mula Memilih Menu</button>
                    </div>`;
                footer.classList.add('hidden');
            } else {
                list.innerHTML = cart.map(item => `
                    <div class="flex items-center gap-4 bg-white p-4 rounded-2xl shadow-sm border border-gray-100">
                        <img src="${item.img}" class="w-16 h-16 object-cover rounded-xl" onerror="this.src='https://placehold.co/100'">
                        <div class="flex-1">
                            <h5 class="font-bold text-xs text-gray-800 leading-tight">${item.name}</h5>
                            <p class="text-gray-400 text-[10px] mt-0.5">RM ${item.price.toFixed(2)} / unit</p>
                            <p class="text-orange-600 text-sm font-black mt-1">RM ${(item.price * item.qty).toFixed(2)}</p>
                        </div>
                        <div class="flex items-center bg-gray-50 rounded-xl border p-1 shadow-inner">
                            <button onclick="changeQty(${item.id}, -1)" class="w-8 h-8 flex items-center justify-center hover:bg-white hover:text-red-500 rounded-lg transition font-bold">-</button>
                            <span class="w-8 text-center font-bold text-sm text-gray-700">${item.qty}</span>
                            <button onclick="changeQty(${item.id}, 1)" class="w-8 h-8 flex items-center justify-center hover:bg-white hover:text-green-600 rounded-lg transition font-bold">+</button>
                        </div>
                    </div>
                `).join('');
                footer.classList.remove('hidden');
            }
            totalEl.textContent = `RM ${totalPrice.toFixed(2)}`;
        }

        function changeQty(id, delta) {
            const idx = cart.findIndex(c => c.id === id);
            if (idx !== -1) {
                cart[idx].qty += delta;
                if (cart[idx].qty <= 0) cart.splice(idx, 1);
            }
            updateUI();
        }

    
function sendOrder() {
    const name = document.getElementById('cust-name').value.trim();
    if (!name) {
        alert("Sila masukkan nama anda sebelum menghantar pesanan!");
        return;
    }

    const whatsappNo = "60168286324";

    let msg = `*PESANAN BARU (WARUNG RASA PADU)*\n`;
    msg += `--------------------------------\n`;
    msg += `ðŸ‘¤ *Pelanggan:* ${name}\n`;
    msg += `ðŸ“… *Tarikh:* ${new Date().toLocaleDateString('ms-MY')}\n`;
    msg += `--------------------------------\n\n`;

    cart.forEach((i, index) => {
        msg += `*${index + 1}. ${i.name}*\n`;
        msg += `   RM${i.price.toFixed(2)} x ${i.qty} = *RM${(i.price * i.qty).toFixed(2)}*\n\n`;
    });

    msg += `--------------------------------\n`;
    msg += `ðŸ’° *JUMLAH BAYARAN: ${document.getElementById('grand-total').textContent}*\n`;
    msg += `--------------------------------\n\n`;
    msg += `_Pesanan dihantar melalui laman web kedai._`;

    const finalUrl = `https://wa.me/${whatsappNo}?text=${encodeURIComponent(msg)}`;

    // âœ… 1ï¸âƒ£ SIMPAN KE GOOGLE SHEET DAHULU
    fetch("https://script.google.com/macros/s/AKfycbyU2kyVCRsnwsDFBNj7so19sqcfUl8lvqmN5vG8ZMCmhtmg0jYL7vG_MdROt2JrXXs/exec", {
        method: "POST",
        body: JSON.stringify({
            nama: name,
            items: cart.map(i => ({
                name: i.name,
                qty: i.qty,
                price: i.price
            }))
        })
    })
    .then(() => {
        console.log("Order saved to Google Sheet");

        // âœ… 2ï¸âƒ£ BARU BUKA WHATSAPP
        window.open(finalUrl, "_blank");
    })
    .catch(err => {
        console.error("Google Sheet error:", err);
        alert("Order gagal disimpan. Sila cuba semula.");
    });
}



