<!DOCTYPE html>
<html lang="ms">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Panel Admin - Warung Rasa Padu</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">

<!-- HEADER -->
<header class="bg-white shadow p-6">
  <h1 class="text-2xl font-bold flex items-center gap-2">
    ðŸ“Š PANEL ADMIN
  </h1>
</header>

<!-- SUMMARY -->
<section class="max-w-6xl mx-auto mt-6 px-4">
  <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
    <div class="bg-white rounded-xl p-4 shadow">
      <p class="text-gray-500 text-sm">Tarikh</p>
      <p id="tarikh" class="text-xl font-bold">-</p>
    </div>
    <div class="bg-white rounded-xl p-4 shadow">
      <p class="text-gray-500 text-sm">Jumlah Order</p>
      <p id="jumlahOrder" class="text-xl font-bold">-</p>
    </div>
    <div class="bg-white rounded-xl p-4 shadow">
      <p class="text-gray-500 text-sm">Jumlah Jualan (RM)</p>
      <p id="jumlahJualan" class="text-xl font-bold">-</p>
    </div>
  </div>
</section>

<!-- TABLE -->
<section class="max-w-6xl mx-auto mt-8 px-4">
  <h2 class="text-lg font-bold mb-3">ðŸ“‹ Senarai Order Hari Ini</h2>

  <div class="bg-white rounded-xl shadow overflow-x-auto">
    <table class="w-full text-sm">
      <thead class="bg-gray-200 text-left">
        <tr>
          <th class="p-3">Masa</th>
          <th class="p-3">Nama</th>
          <th class="p-3">Item</th>
          <th class="p-3">Qty</th>
          <th class="p-3">Harga</th>
          <th class="p-3">Jumlah</th>
        </tr>
      </thead>
      <tbody id="orderTable"></tbody>
    </table>
  </div>
</section>

<!-- SCRIPT -->
<script>
const API_URL = "https://script.google.com/macros/s/AKfycbyU2kyVCRsnwsDFBNj7so19sqcfUl8lvqmN5vG8ZMCmhtmg0jYL7vG_MdROt2JrXXs/exec";

fetch(API_URL)
  .then(res => res.json())
  .then(data => {

    // Summary
    document.getElementById("tarikh").innerText = data.tarikh;
    document.getElementById("jumlahOrder").innerText = data.jumlahOrder;
    document.getElementById("jumlahJualan").innerText = Number(data.jumlahJualan).toFixed(2);

    const tbody = document.getElementById("orderTable");
    tbody.innerHTML = "";

    // Loop ORDER â†’ LOOP ITEM
    data.orders.forEach(order => {
      order.items.forEach(item => {
        const row = `
          <tr class="border-b hover:bg-gray-50">
            <td class="p-3">${order.time}</td>
            <td class="p-3">${order.name}</td>
            <td class="p-3">${item.item}</td>
            <td class="p-3">${item.qty}</td>
            <td class="p-3">RM ${item.price}</td>
            <td class="p-3 font-bold">RM ${item.total}</td>
          </tr>
        `;
        tbody.innerHTML += row;
      });
    });

  })
  .catch(err => {
    console.error("Admin fetch error:", err);
    alert("Gagal load data admin");
  });
</script>

</body>
</html>
